!function(a){function b(a,b,c){if(a.attr("data-state","open"),b.slideDown(c.openSpeed),"siblings"==c.multiFolder){var d=a.parent().parent().find("ul"),e=a.parents("span+ul"),f=e.parent().parent().find("ul:visible").not(e).not(d);sbulch=d.not(b).children().children("ul:visible"),f=f.add(sbulch).add(sbulch.find("ul:visible")),f.slideUp(c.closeSpeed).prev().removeAttr("data-state")}else c.multiFolder||a.parent().parent().children("li").children("ul:visible").not(b).slideUp(c.closeSpeed).prev().removeAttr("data-state")}function c(a,b,c){if("siblings"==c.multiFolder){var d=b.add(b.children().children("ul").find("ul:visible"));d.slideUp(c.closeSpeed).prev().removeAttr("data-state")}else b.slideUp(c.closeSpeed),a.removeAttr("data-state")}function d(b,c){b.each(function(){var b=a(this),d=b.next();if(!d.length){var e=b.html().split(".").pop(),f=c.icon,g="none";for(l in c.icons)if(l=c.icons[l],a.inArray(e,l.ext)>-1){g=l.type,f=l.icon;break}b.data("ext",e).data("type",g).css("background-image","url("+c.iconFolder+f+")")}})}a.expr[":"].jtreeFiles=function(b){return 0==a(b).next("ul").length},a.expr[":"].jtreeFolder=function(b){return 1==a(b).next("ul").length},a.expr[":"].jtreeOpen=function(b){return"open"==a(b).attr("data-state")},a.expr[":"].jtreeClose=function(b){return"open"!=a(b).attr("data-state")},a.expr[":"].jtreeIs=function(b,c,d){return a.inArray(a(b).data("ext"),d[3].split(","))>-1},a.expr[":"].jtreeOf=function(b,c,d){return a.inArray(a(b).data("type"),d[3].split(","))>-1},a.expr[":"].jtreeNot=function(b,c,d){return a.inArray(a(b).data("ext"),d[3].split(","))<=-1},a.expr[":"].jtreeNotOf=function(b,c,d){return a.inArray(a(b).data("type"),d[3].split(","))<=-1},a.expr[":"].jtreeEmpty=function(b){return a(b).next("ul:empty").length},a.expr[":"].jtreeFill=function(b){return a(b).next("ul:parent").length},a.expr[":"].jtreeNameHas=function(b,c,d){return 1==a(b).filter(":contains("+d[3]+")").length},a.expr[":"].jtreeNotNameHas=function(b,c,d){return 0==a(b).filter(":contains("+d[3]+")").length},a.expr[":"].jtreeNameIs=function(b,c,d){return a(b).text()==d[3]},a.expr[":"].jtreeNotNameIs=function(b,c,d){return a(b).text()!=d[3]},a.expr[":"].jtreeMNameIs=function(b,c,d){return a.inArray(a(b).text(),d[3].split(","))>-1},a.expr[":"].jtreeMNotNameIs=function(b,c,d){return a.inArray(a(b).text(),d[3].split(","))<=-1},a.fn.jtree=function(e){var f=a.extend({},a.fn.jtree.dopt,e);return this.each(function(){var e=a(this).find("span:not([data-style=unclosable])");f.autoToggle&&e.click(function(){var d=a(this),e=d.next();1==e.length&&("open"!=d.attr("data-state")?b(d,e,f):c(d,e,f))}),d(e,f)})},a.fn.jtreeFolders=function(b){var c=a(this);return c.is("span")&&(c=c.next()),"string"==typeof b?c.find("span+ul").prev(b):c.find("span+ul").prev()},a.fn.jtreeFiles=function(b){var c=a(this);c.is("span")&&(c=c.next());var d=c.find("span");return d=d.not(d.next().prev()),"string"==typeof b?d.filter(b):d},a.fn.jtreeAll=function(b){return"string"==typeof b?a(this).find("span"+b):a(this).find("span")},a.fn.jtreeChildFolders=function(b){var c=a(this);c.is("span")&&(c=c.next());var d=c.children("li").children("span+ul");return"string"==typeof b?d.prev(b):d.prev()},a.fn.jtreeChildFiles=function(b){var c=a(this);c.is("span")&&(c=c.next()),c=c.children("li");var d=c.children("span");return d=d.not(d.next("ul").prev()),"string"==typeof b?d.filter(b):d},a.fn.jtreeChildAll=function(b){var c=a(this);return c.is("span")&&(c=c.next()),"string"==typeof b?c.children("li>span"+b):c.children("li>span")},a.fn.jtreeOpened=function(){return"open"==a(this).attr("data-state")},a.fn.jtreeClose=function(b){var d=a(this);if("unclosable"==d.attr("data-style"))return this;var e=a.extend({},a.fn.jtree.dopt,b);return c(d,d.next(),e),this},a.fn.jtreeOpen=function(c){var d=a.extend({},a.fn.jtree.dopt,c),e=a(this),f=e.next();return 1!=f.length?this:(b(e,f,d),this)},a.fn.jtreeToggle=function(d){var e=a.extend({},a.fn.jtree.dopt,d),f=a(this),g=f.next();if(1!=g.length)return this;if("open"!=f.attr("data-state"))b(f,g,e);else{if(f.is("[data-style=unclosable]"))return this;c(f,g,e)}return this},a.fn.jtreeRemove=function(b){var c=a.extend({},a.fn.jtree.dopt,b),d=a(this).parent(),e=d.parent().prev(),f=d.filter(":hidden");return d=d.not(f),f.remove(),d.addClass("todel").slideUp(c.removeTime,function(){a(this).remove()}),e},a.fn.jtreeRemoveAllEmpty=function(b){var c=a(this),d=0;c.find("li:not(.todel)>ul:empty").parent().addClass("todel");do d=0,ul=a.unique(c.find("li:not(.todel) > ul > li.todel").parent("ul")),ul.each(function(){$t=a(this),0==$t.children("li:not(.todel)").length&&(a.unique($t.parent("li")).addClass("todel"),d=1)});while(d);c.find("li.todel").children("span").jtreeRemove(b)},a.fn.jtreeCreateFile=function(b,c){return a(this).jtreeInsert("file",b,c)},a.fn.jtreeCreateFolder=function(b,c){return a(this).jtreeInsert("folder",b,c)},a.fn.jtreeMoveTo=function(b,c,d){var e=a.extend({},a.fn.jtree.dopt,c),f=a(this);if(!f.length||!b.length||f.is(b))return!1;var g=f.next(),h=f.parent(),i=b.next();if(i.length||(i=b.parent().parent()),g.length){if(g.parent().parent().is(i)||g.find(b).length)return!1;var j="folder"}else{if(h.parent().is(i))return!1;var j="file"}if(a.isFunction(d)){var k=f.text(),l=f.jtreeGetPath(),m=i.prev().jtreeGetPath();if(""!=m&&(m+="/"),m+=k,!1===d(l,m))return!1}return h.slideUp(e.removeTime,function(){h.detach(),b.jtreeInsert(j,h,c)}),i.prev()},a.fn.jtreeInsert=function(b,c,d){var e=a.extend({},a.fn.jtree.dopt,d),f=a(this),g=f.next();g.length||(g=f.parent().parent(),f=g.prev());var h=g.children("li"),i=!1,j=h.children("span+ul").prev();if("folder"!=b){j=h.children("span").not(j);var k="</span></li>"}else var k="</span><ul></ul></li>";if("string"==typeof c)var l=a("<li><span>"+c+k).jtree(e),m=c;else var l=c,m=l.children("span").text();return l.hide(),j.length?(j.each(function(){var b=a(this);return b.text()>m?(i=l.insertBefore(b.parent()),!1):void 0}),i===!1&&(i=l.insertAfter(j.last().parent()))):i="folder"!=b?l.appendTo(g):l.prependTo(g),i.slideDown(e.appendTime).children("span")},a.fn.jtreeParent=function(){var b=a(this);return b.is("ul.jtree>li>span")?this:b.parent().parent().prev()},a.fn.jtreeParentList=function(){return a(this).parent().parent()},a.fn.jtreeGetList=function(){return a(this).next()},a.fn.jtreeSelect=function(b){var c=a(this);if(c.is("ul.jtree"))var d=c.children();else var d=c.parentsUntil("ul.jtree").last();d=d.children("span").next();var e=b.split("/");e=a.grep(e,function(a){return a});var f=e.length,g=0;"root"==e[0]&&(g=1);for(var h=g;f-1>h;h++){var i=d.children("li").children("span+ul").prev("span:jtreeNameIs("+e[h]+")").last();if(!i.length)return d.prev();d=i.next()}return i=d.children("li").children("span:jtreeNameIs("+e[f-1]+")").last(),i.length?i:d.prev()},a.fn.jtreeReverse=[].reverse,a.fn.jtreeOpenTo=function(c){var d=a(this),e=a.extend({},a.fn.jtree.dopt,c),f=d.next("ul").add(d.parentsUntil("ul.jtree","ul"));return f=f.prev().filter(":jtreeClose").next(),f.length||(f=d.next("ul")),f.each(function(c){var d=a(this);b(d.prev(),d.delay(e.multiOpenDelay*c),e)}),this},a.fn.jtreeGoTo=function(b,c){return a(this).jtreeSelect(b).jtreeOpenTo(c)},a.fn.jtreeSearchFile=function(b,c){var d=a(this).find("span:contains("+b+")");return d=d.not(d.next("ul").prev()),"exact"==c?d.filter(":jtreeNameIs("+b+")"):d},a.fn.jtreeSearchFolder=function(b,c){var d=a(this).find("span:contains("+b+")").next("ul").prev();return"exact"==c?d.filter(":jtreeNameIs("+b+")"):d},a.fn.jtreeSearch=function(b,c){var d=a(this).find("span:contains("+b+")");return"exact"==c?d.filter(":jtreeNameIs("+b+")"):d},a.fn.jtreeGetPath=function(){var b=a(this);if(b.is("ul.jtree>li>span"))return"";var c=b.parents("span+ul").not("ul.jtree>li>ul").prev(),d="";return c.each(function(){d=a(this).html()+"/"+d}),d+b.html()},a.fn.jtree.dopt={autoToggle:!0,multiFolder:"siblings",iconFolder:"/img/icons/",icons:[{type:"image",icon:"images.png",ext:["jpg","jpeg","gif","png","bmp"]},{type:"source",icon:"page_code.png",ext:["htm","html","php","txt"]}],openSpeed:500,closeSpeed:500,appendTime:1e3,removeTime:1e3,multiOpenDelay:500,icon:"page_white.png"}}(jQuery);